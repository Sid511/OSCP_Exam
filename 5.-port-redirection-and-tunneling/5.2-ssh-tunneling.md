# 5.2 SSH Tunneling

## SSH Tunneling

![](../.gitbook/assets/image%20%2823%29.png)

* Here the,
  * delivery protocol is SSH on port 22.

## There are three ways of SSH tunneling

1. Dynamic SSH tunneling
2. Local port forwarding using SSH tunneling
3. Remote port forwarding using SSH tunneling

## Dynamic SSH tunneling

* We need to setup a SOCKS proxy,
  * We first need a **proxy server on client side**.
  * We then need to configure the other end of the communication to accept traffic.
* We then need to either configure all application configurations manually or automatically to "tell all applications to use the client side SOCKS proxy for communication". 
* So all the requests of internet are now sent to proxy.

### Dynamic SSH tunneling using SSH

```text
ssh -D 85 user@192.168.1.1
```

* The above commands configures an SSH Tunnel
  * -D bind port. Which specifies the delivery connection port.
  * one end \(local\) of the SSH tunnel is the system where the above command is executed. the other end is 192.168.1.1 using username "user".

![SSH -D option description](../.gitbook/assets/image%20%287%29.png)

![Dynamic SSH Tunneling](../.gitbook/assets/image%20%2819%29.png)

## SSH Local Port forwarding

* On our client machine we will open URL _http://127.0.0.1:8080_.
* Note that 8080 = 80. Actually by 8080 we are just asking to use http service.
* This request will be internally tunneled on port 53 by configured SSH tunnel.
* We have a similar relay server which helps as communicator.

![](../.gitbook/assets/image%20%2812%29.png)

### SSH Remote Port forwarding

* Given we RDP ports are not allowed through firewall means 3389 and 2290 are blocked at firewall level.
* And given only port 53 is allowed.
* Given that the victim machine has RDP services active and running on port 3389.
* We will use SSH port tunneling technique to talk directly to the server. We do not need relay server in this kind of exploits.

![](../.gitbook/assets/image%20%2825%29.png)

## Dynamic Port forwarding

![](../.gitbook/assets/image%20%2828%29.png)

